--ESTA ES LA MODA--

# --- 3. Preprocesamiento de Datos ---
print("\n" + "="*60)
print("--- 3. Preprocesamiento de Datos ---")
print("="*60)

# Este es el punto 3 de la 1ra parte: Imputación de valores faltantes (con la moda)

# Verificar si hay valores faltantes en cada columna antes de la imputación
print("\nValores faltantes por columna antes de la imputación:")
print(df.isnull().sum())

# Imputar valores faltantes en todas las columnas con la moda
for column in df.columns:
    if df[column].isnull().any():
        try:
            mode_value = df[column].mode()[0]  # mode() puede devolver múltiples valores, tomamos el primero
            df[column].fillna(mode_value, inplace=True)
            print(f"Valores faltantes en '{column}' imputados con la moda ('{mode_value}').")
        except Exception as e:
            print(f"Error al imputar la columna '{column}' con la moda: {e}")
    else:
        print(f"La columna '{column}' no tiene valores faltantes.")

# Verificar si quedan valores faltantes después de la imputación
print("\nValores faltantes por columna después de la imputación:")
print(df.isnull().sum())

print("\n--- Fin del Preprocesamiento de Datos ---")
print("="*60)